Lmod has detected the following error: The following module(s) are unknown:
"anaconda3"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "anaconda3"

Also make sure that all modulefiles written in TCL start with the string
#%Module



/u/mbanisharifdehkordi/gnn-env/lib/python3.12/site-packages/torch_geometric/typing.py:86: UserWarning: An issue occurred while importing 'torch-scatter'. Disabling its usage. Stacktrace: /u/mbanisharifdehkordi/gnn-env/lib/python3.12/site-packages/torch_scatter/_scatter_cuda.so: undefined symbol: _ZN2at4_ops16div__Tensor_mode4callERNS_6TensorERKS2_St8optionalIN3c1017basic_string_viewIcEEE
  warnings.warn(f"An issue occurred while importing 'torch-scatter'. "
/u/mbanisharifdehkordi/gnn-env/lib/python3.12/site-packages/torch_geometric/typing.py:124: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /u/mbanisharifdehkordi/gnn-env/lib/python3.12/site-packages/torch_sparse/_spmm_cuda.so: undefined symbol: _ZN5torch8autograd12VariableInfoC1ERKN2at6TensorE
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
2025-04-07 17:51:08,893 - INFO - Using device: cuda
2025-04-07 17:51:08,893 - INFO - Using split-based workflow with directories: data/preprocessed/baseline_gcn/experiment_2/train, data/preprocessed/baseline_gcn/experiment_2/val, data/preprocessed/baseline_gcn/experiment_2/test
2025-04-07 17:51:09,179 - INFO - Creating datasets from split directories...
2025-04-07 17:51:37,420 - INFO - Train/Val/Test sizes: 700000/150000/150000
2025-04-07 17:51:37,420 - INFO - Creating GCN model with 2 layers and 64 hidden dimensions
2025-04-07 17:51:37,475 - INFO - Initialized GCN model with 2 layers and 64 hidden dimensions
2025-04-07 17:51:37,475 - INFO - Initialized GNN regressor with GCN backbone
2025-04-07 17:51:37,761 - INFO - No checkpoint found or resume disabled. Starting training from scratch.
2025-04-07 17:51:37,761 - INFO - Starting training for 100 epochs (from epoch 1)
/u/mbanisharifdehkordi/gnn-env/lib/python3.12/site-packages/torch/nn/modules/loss.py:610: UserWarning: Using a target size (torch.Size([32])) that is different to the input size (torch.Size([32, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
/u/mbanisharifdehkordi/gnn-env/lib/python3.12/site-packages/torch/nn/modules/loss.py:610: UserWarning: Using a target size (torch.Size([16])) that is different to the input size (torch.Size([16, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
2025-04-07 17:53:38,649 - INFO - Epoch 1/100, Train Loss: 54963492.4177, Val Loss: 335448.5541
2025-04-07 17:53:38,660 - INFO - Saved best model with validation loss: 335448.5541
2025-04-07 17:55:38,969 - INFO - Epoch 2/100, Train Loss: 27172505.6646, Val Loss: 1659252.8722
2025-04-07 17:57:39,281 - INFO - Epoch 3/100, Train Loss: 3213833.3385, Val Loss: 92.2615
2025-04-07 17:57:39,294 - INFO - Saved best model with validation loss: 92.2615
2025-04-07 17:59:39,276 - INFO - Epoch 4/100, Train Loss: 1.7167, Val Loss: 0.9478
2025-04-07 17:59:39,289 - INFO - Saved best model with validation loss: 0.9478
2025-04-07 18:01:39,857 - INFO - Epoch 5/100, Train Loss: 0.9499, Val Loss: 0.9473
2025-04-07 18:01:39,869 - INFO - Saved best model with validation loss: 0.9473
2025-04-07 18:03:39,494 - INFO - Epoch 6/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:03:39,505 - INFO - Saved best model with validation loss: 0.9473
2025-04-07 18:05:40,077 - INFO - Epoch 7/100, Train Loss: 0.9485, Val Loss: 0.9474
2025-04-07 18:07:40,722 - INFO - Epoch 8/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:09:40,836 - INFO - Epoch 9/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:09:40,849 - INFO - Saved best model with validation loss: 0.9473
2025-04-07 18:11:42,318 - INFO - Epoch 10/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:13:43,360 - INFO - Epoch 11/100, Train Loss: 0.9485, Val Loss: 0.9476
2025-04-07 18:15:43,385 - INFO - Epoch 12/100, Train Loss: 0.9485, Val Loss: 0.9475
2025-04-07 18:17:43,228 - INFO - Epoch 13/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:19:43,259 - INFO - Epoch 14/100, Train Loss: 0.9485, Val Loss: 0.9474
2025-04-07 18:21:42,924 - INFO - Epoch 15/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:23:43,324 - INFO - Epoch 16/100, Train Loss: 0.9485, Val Loss: 0.9477
2025-04-07 18:25:43,184 - INFO - Epoch 17/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:27:42,211 - INFO - Epoch 18/100, Train Loss: 0.9485, Val Loss: 0.9473
2025-04-07 18:29:40,672 - INFO - Epoch 19/100, Train Loss: 0.9485, Val Loss: 0.9475
2025-04-07 18:29:40,679 - INFO - Early stopping triggered after 19 epochs
2025-04-07 18:29:40,679 - INFO - Training completed in 2282.92 seconds
2025-04-07 18:29:40,687 - INFO - Loaded best model from epoch 9 for evaluation
2025-04-07 18:29:40,687 - INFO - Evaluating model on test set...
2025-04-07 18:29:56,819 - INFO - Test Loss: 0.9558
/var/spool/slurmd/job8948752/slurm_script: line 47: 1613313 Killed                  python scripts/02_train_model.py --train_dir ${TRAIN_DIR} --val_dir ${VAL_DIR} --test_dir ${TEST_DIR} --output_dir ${OUTPUT_DIR} --model_type gcn --hidden_dim 64 --num_layers 2 --learning_rate 0.001 --batch_size 32 --epochs 100 --dropout 0.1 --early_stopping_patience 10 --device cuda --use_split_dirs True --resume_training True
slurmstepd: error: Detected 1 oom_kill event in StepId=8948752.batch. Some of the step tasks have been OOM Killed.
